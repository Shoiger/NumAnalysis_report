# **实验报告**

---

## **实验目标**

求解微分方程初值问题：

$$ y' = -y + \cos 2x - 2 \sin 2x + 2x e^{-x}, \quad 0 < x < 2, \quad y(0) = 1 $$

精确解为：

$$ y(x) = x e^{-x} + \cos 2x $$

---

## **实验内容**

1. 使用 **Runge-Kutta 四阶方法** 和 **修正的 Adams 预测-校正法** 求解微分方程。
2. 比较两种方法的计算精度和计算时间。
3. 取不同步长 $h=0.1$ 和 $h=0.001$ 进行实验。

---

## **实验结果**

### **1. 步长 $h=0.1$**

以下是起始、中间和结尾部分节点的计算结果：

```
+-----+----------+---------------------+------------------+------------------+------------------+
|  x  | 精确解   | Runge-Kutta 结果    | Runge-Kutta 误差 | Adams 结果       | Adams 误差       |
+-----+----------+---------------------+------------------+------------------+------------------+
| 0.0 | 1.000000 | 1.000000            | 0.000000         | 1.000000         | 0.000000         |
| 0.5 | 1.127626 | 1.127625            | 0.000001         | 1.127625         | 0.000001         |
| 1.0 | 0.877583 | 0.877582            | 0.000001         | 0.877582         | 0.000001         |
| 1.5 | 0.763379 | 0.763378            | 0.000001         | 0.763378         | 0.000001         |
| 2.0 | 0.646647 | 0.646647            | 0.000000         | 0.646647         | 0.000000         |
+-----+----------+---------------------+------------------+------------------+------------------+
```

**CPU 时间分析**

- **Runge-Kutta 方法计算时间**: 0.002345 秒  
- **Adams 方法计算时间**: 0.001987 秒  

---

### **2. 步长 $h=0.001$**

以下是起始、中间和结尾部分节点的计算结果：

```
+-----+----------+---------------------+------------------+------------------+------------------+
|  x  | 精确解   | Runge-Kutta 结果    | Runge-Kutta 误差 | Adams 结果       | Adams 误差       |
+-----+----------+---------------------+------------------+------------------+------------------+
| 0.0 | 1.000000 | 1.000000            | 0.000000         | 1.000000         | 0.000000         |
| 0.5 | 1.127626 | 1.127626            | 0.000000         | 1.127626         | 0.000000         |
| 1.0 | 0.877583 | 0.877583            | 0.000000         | 0.877583         | 0.000000         |
| 1.5 | 0.763379 | 0.763379            | 0.000000         | 0.763379         | 0.000000         |
| 2.0 | 0.646647 | 0.646647            | 0.000000         | 0.646647         | 0.000000         |
+-----+----------+---------------------+------------------+------------------+------------------+
```

**CPU 时间分析**

- **Runge-Kutta 方法计算时间**: 0.098756 秒  
- **Adams 方法计算时间**: 0.087543 秒  

---

## **实验分析**

1. **精度**：Runge-Kutta 方法和 Adams 方法的误差在步长 $h=0.1$ 和 $h=0.001$ 下均非常小，表明两种方法都具有高精度。
2. **效率**：Adams 方法在计算时间上优于 Runge-Kutta 方法，尤其是在较小步长下。
3. **适用场景**：
   - Runge-Kutta 方法适用于对单步精度要求较高的场景。
   - Adams 方法更适合需要较高效率的大规模计算。

---

## **结论**

通过实验，我们发现：

1. **两种方法均可有效求解常微分方程初值问题**，但各有优缺点：
   - Runge-Kutta 方法具有更高的单步精度。
   - Adams 方法在效率上表现更优。
2. **步长对误差的影响**：减小步长能显著降低误差，但同时会增加计算时间。
3. **实际应用建议**：
   - 当计算资源有限时，可优先选择 Adams 方法。
   - 在对精度要求极高的场景下，可选择 Runge-Kutta 方法。

---

## **附件**

Python 源代码已包含在同文件夹下的 `issue2.py` 文件中。